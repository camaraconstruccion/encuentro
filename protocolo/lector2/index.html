<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Encuentro de constructores Abril 2023</title>
		<link rel="icon" type="image/ico" href="favicon.ico">
		<link rel="stylesheet" href="./lector.css">
      <script type="text/javascript" src="../js/funciones.js"></script>
		<script type="text/javascript" src="./instascan.min.js"></script>
	</head>
	<body>
		<div id="pantalla1">
			<div id="tituloconferencias" class="campos" style="width: 100%; margin-bottom: 10px; display: flex;">
				<div style="width: 100%; text-align: center; font-size: 110%;">
					<label for=""><b>Seleccione conferencia</b></label>
				</div>
			</div>
			<div id="div-conf01" class="campos" style="width: 100%; margin-bottom: 10px; display: flex;">
				<input id="conf01" type="radio" name="conferencia" value="" style="width: 25px; height: 18px;">
				<div style="width: 100%; text-align: justify; margin-left: 2%;">
					<label for="">9:10 am. 9,50 am. - Enrique Madureri. "Construcción, un impulso hacia adelante. Propuestas"</label>
				</div>
			</div>
			<div id="div-conf02" class="campos" style="width: 100%; margin-bottom: 10px; display: flex;">
				<input id="conf02" type="radio" name="conferencia" value="" style="width: 25px; height: 18px;">
				<div style="width: 100%; text-align: justify; margin-left: 2%;">
					<label for="">10,00 am- 10,40 am. - Alberto Manosalva. "Turismo como dinamizador del sector construcción"</label>
				</div>
			</div>
			<div id="div-conf03" class="campos" style="width: 100%; margin-bottom: 10px; display: flex;">
				<input id="conf03" type="radio" name="conferencia" value="" style="width: 25px; height: 18px;">
				<div style="width: 100%; text-align: justify; margin-left: 2%;">
					<label for="">10,50 am a 11,30 am. - Alan Isea. "Activando la Venezuela Verde. Eficiencia energética"</label>
				</div>
			</div>
			<div id="div-conf04" class="campos" style="width: 100%; margin-bottom: 10px; display: flex;">
				<input id="conf04" type="radio" name="conferencia" value="" style="width: 25px; height: 18px;">
				<div style="width: 100%; text-align: justify; margin-left: 2%;">
					<label for="">11,40 pm - 12,20 pm. - Andrés Montiel. "Control solar, aislamiento acústico y ahorro de energía. La nueva tendencia en el mercado del vidrio para cerramientos comerciales y residenciales"</label>
				</div>
			</div>
			<div id="div-conf05" class="campos" style="width: 100%; margin-bottom: 10px; display: flex;">
				<input id="conf05" type="radio" name="conferencia" value="" style="width: 25px; height: 18px;">
				<div style="width: 100%; text-align: justify; margin-left: 2%;">
					<label for="">1,00 pm - 1,40 am. - Edson Martínez Oberto. "Rediseño curricular Ingeniería Civil de la Universidad de Carabobo. Abriendo las puertas al futuro"</label>
				</div>
			</div>
			<div id="div-conf06" class="campos" style="width: 100%; margin-bottom: 10px; display: flex;">
				<input id="conf06" type="radio" name="conferencia" value="" style="width: 25px; height: 18px;">
				<div style="width: 100%; text-align: justify; margin-left: 2%;">
					<label for="">1,50 a 2,30 pm. - Bernys Jiménez. “Innovación, sustentabilidad y química para la construcción vigente desde 1910. Sika Venezuela mas allá de las expectativas”</label>
				</div>
			</div>
			<div id="div-conf07" class="campos" style="width: 100%; margin-bottom: 10px; display: flex;">
				<input id="conf07" type="radio" name="conferencia" value="" style="width: 25px; height: 18px;">
				<div style="width: 100%; text-align: justify; margin-left: 2%;">
					<label for="">2,40 pm am- 3,20 pm. - Guillermo García. "Cómo puede el sector construcción acceder al financiamiento a través del mercado de capitales. Titularización"</label>
				</div>
			</div>
			<div id="div-conf08" class="campos" style="width: 100%; margin-bottom: 10px; display: flex;">
				<input id="conf08" type="radio" name="conferencia" value="" style="width: 25px; height: 18px;">
				<div style="width: 100%; text-align: justify; margin-left: 2%;">
					<label for="">3,20 pm a 4,10 pm. - Reinaldo Quintero. "Construcción y Petróleo, un camino común de oportunidades y compromisos"</label>
				</div>
			</div>
			<div id="div-conf09" class="campos" style="width: 100%; margin-bottom: 10px; display: flex;">
				<input id="conf09" type="radio" name="conferencia" value="" style="width: 25px; height: 18px;">
				<div style="width: 100%; text-align: justify; margin-left: 2%;">
					<label for="">4,20 pm a 5,10 pm. - Roberto Fernando Esparragoza. "La Evolución de la Construcción y la influencia de la Tecnologia en los Materiales en la mejora de la calidad, tiempos de ejecución, procesos constructivos y costos en los proyectos"</label>
				</div>
			</div>
			<div id="div-conf10" class="campos" style="width: 100%; margin-bottom: 10px; display: flex;">
				<input id="conf10" type="radio" name="conferencia" value="" style="width: 25px; height: 18px;">
				<div style="width: 100%; text-align: justify; margin-left: 2%;">
					<label for="">5,20 pm a 6,00 pm. - Arturo Facchin. "Activa la Resilencia de tu Inmueble. Una herramienta para la reactivación del sector construcción"</label>
				</div>
			</div>
			<div style="width: 100%; text-align: center;">
				<button id="seguir" style="width: 60px; height: 30px; margin: auto;" onclick="seguiradelante()">Seguir</button>
			</div>
		</div>
		<div id="pantalla2" style="width: 100%; align-items: center; display: none;">
			<h3 id="tituloformulario" align="center" style="margin-top: 10px;">LECTOR DE CÓDIGOS QR</h3>
			<p align="center">Coloque el código en el siguiente recuadro.</p>
			<div class="framevideo" >
				<div class="frame2">
					<video id="preview" class="vd"></video>
					<div class="scanner-laser laser-rightBottom"></div>
					<div class="scanner-laser laser-rightTop"></div>
					<div class="scanner-laser laser-leftBottom"></div>
					<div class="scanner-laser laser-leftTop"></div>
				</div>
			</div>
		</div>
		<div style="width: 100%; margin-top: 48%; text-align: center;">
			<p id="mensaje" align="center"></p>
			<br/>
			<button id="volver" style="width: 60px; height: 30px; margin: auto;" onclick="volveralmenu()">Volver</button>
			<audio id="beep" src="" />
		</div>
		<script type="text/javascript">
         const operador = localStorage.getItem("nombre");
         const dia      = localStorage.getItem("dia");
			let xConferencia = "";
			let salir      = localStorage.getItem("url_bck2");
         let beep       = './audio/beep.mp3';

			let scanner = new Instascan.Scanner({ video: document.getElementById('preview') });

			scanner.addListener('scan', function (content) {
				if (content) {
               mensaje = 'Cantidad de personas:';
               cantidad = prompt(mensaje,1)
               if (cantidad!=0 && cantidad!=null) {
                  if (confirm('¿Confirmar pase?')) {
                     confirmar(beep, content, cantidad);
                  }
               }
				}
					// console.log('x');
					// confirmar(beep, content); }
					// alert(content);
			});

			Instascan.Camera.getCameras().then(function (cameras) {
				back = 0;
				for (i=0; i< cameras.length; i++) {
					if (cameras[i].name.indexOf('back') >= 0) { back = i }
				}
				if (cameras.length > 0) {
					scanner.mirror = false;
					scanner.start(cameras[back]);
				} else {
					console.error('No cameras found.');
				}
			}).catch(function (e) {
				console.error(e);
			});

			function seguiradelante() {
				xConferencia = "";
				document.getElementsByName("conferencia").forEach(element => {
					if (element.checked) {
						xConferencia = element.id;
					}
				});
				if (xConferencia=="") {
					alert('Debe selecccionar una conferencia');
				} else {
					document.getElementById('pantalla1').style.display = none;
					document.getElementById('pantalla2').style.display = block;
				}
			}

         function volveralmenu() {
            window.location.replace(salir);
         }

			function confirmar(sonido, contenido, cantidad) {
				document.getElementById('beep').src = sonido;
				let sound = document.getElementById('beep');
				if (sound) { sound.play(); }
				xURL = contenido.split('?');
				yURL = xURL[1].split('=');
				zURL = yURL[1];
				aURL = xURL[0].split('.php');
				console.log(aURL[0]);
				// console.log(aURL[0]+'?id='+zURL+'&operador='+operador+'&dia='+dia+'&cantidad='+cantidad);
				// URL = contenido+'&operador='+operador+'&dia='+dia+'&cantidad='+cantidad;
				// URL = aURL[0]+'?id='+zURL+'&operador='+operador+'&dia='+dia+'&cantidad='+cantidad;
				// fetch(URL, {
				// 	method: 'GET', 
				// 	mode: 'no-cors'
				// })

				URL = 'https://app.cash-flag.com/apis/expo/confirmaconferencias';
				
				let data = new FormData();
            data.append("operador",    operador);
            data.append("dia",         dia);
            data.append("conferencia", xConferencia);
            data.append("id",          zURL);
            data.append("cantidad",    cantidad);

            fetch(URL, {
               method: 'POST',
               body: data
            })
            .then((response) => response.json())
            .then((responseData) => {
					console.log(responseData);
               if (responseData.exito=="SI") {
                  alert(responseData.mensaje);
               } else {
                  alert(responseData.mensaje);
               }
            });
			}
		</script>
	</body>
</html>

<!-- 
<html>
  <head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba Instascan</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="style.css">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/webrtc-adapter/3.3.3/adapter.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.1.10/vue.min.js"></script>
    <script type="text/javascript" src="https://rawgit.com/schmich/instascan-builds/master/instascan.min.js"></script>
  </head>
  <body>
    <div id="app">
      <div class="sidebar">
        <section class="cameras">
          <h2>Cameras</h2>
          <ul>
            <li v-if="cameras.length === 0" class="empty">No cameras found</li>
            <li v-for="camera in cameras">
              <span v-if="camera.id == activeCameraId" :title="formatName(camera.name)" class="active">{{ formatName(camera.name) }}</span>
              <span v-if="camera.id != activeCameraId" :title="formatName(camera.name)">
                <a @click.stop="selectCamera(camera)">{{ formatName(camera.name) }}</a>
              </span>
            </li>
          </ul>
        </section>
        <section class="scans">
          <h2>Scans</h2>
          <ul v-if="scans.length === 0">
            <li class="empty">No scans yet</li>
          </ul>
          <transition-group name="scans" tag="ul">
            <li v-for="scan in scans" :key="scan.date" :title="scan.content">{{ scan.content }}</li>
          </transition-group>
        </section>
      </div>
      <div class="preview-container">
        <video id="preview"></video>
      </div>
    </div>
    <script type="text/javascript" src="app.js"></script>
  </body>
</html>
 -->